(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();let l=Object.getPrototypeOf,m,C,h,p,$={isConnected:1},U=1e3,v,X={},Y=l($),M=l(l),c,q=(e,r,n,t)=>(e??(setTimeout(n,t),new Set)).add(r),F=(e,r,n)=>{let t=h;h=r;try{return e(n)}catch(o){return console.error(o),n}finally{h=t}},y=e=>e.filter(r=>r._dom?.isConnected),T=e=>v=q(v,e,()=>{for(let r of v)r._bindings=y(r._bindings),r._listeners=y(r._listeners);v=c},U),b={get val(){return h?._getters?.add(this),this.rawVal},get oldVal(){return h?._getters?.add(this),this._oldVal},set val(e){h?._setters?.add(this),e!==this.rawVal&&(this.rawVal=e,this._bindings.length+this._listeners.length?(C?.add(this),m=q(m,this,Z)):this._oldVal=e)}},W=e=>({__proto__:b,rawVal:e,_oldVal:e,_bindings:[],_listeners:[]}),w=(e,r)=>{let n={_getters:new Set,_setters:new Set},t={f:e},o=p;p=[];let s=F(e,n,r);s=(s??document).nodeType?s:new Text(s);for(let i of n._getters)n._setters.has(i)||(T(i),i._bindings.push(t));for(let i of p)i._dom=s;return p=o,t._dom=s},O=(e,r=W(),n)=>{let t={_getters:new Set,_setters:new Set},o={f:e,s:r};o._dom=n??p?.push(o)??$,r.val=F(e,t,r.rawVal);for(let s of t._getters)t._setters.has(s)||(T(s),s._listeners.push(o));return r},k=(e,...r)=>{for(let n of r.flat(1/0)){let t=l(n??0),o=t===b?w(()=>n.val):t===M?w(n):n;o!=c&&e.append(o)}return e},z=(e,r,...n)=>{let[{is:t,...o},...s]=l(n[0]??0)===Y?n:[{},...n],i=e?document.createElementNS(e,r,{is:t}):document.createElement(r,{is:t});for(let[u,f]of Object.entries(o)){let V=g=>g?Object.getOwnPropertyDescriptor(g,u)??V(l(g)):c,J=r+","+u,L=X[J]??=V(l(i))?.set??0,E=u.startsWith("on")?(g,Q)=>{let I=u.slice(2);i.removeEventListener(I,Q),i.addEventListener(I,g)}:L?L.bind(i):i.setAttribute.bind(i,u),P=l(f??0);u.startsWith("on")||P===M&&(f=O(f),P=b),P===b?w(()=>(E(f.val,f._oldVal),i)):E(f)}return k(i,s)},x=e=>({get:(r,n)=>z.bind(c,e,n)}),G=(e,r)=>r?r!==e&&e.replaceWith(r):e.remove(),Z=()=>{let e=0,r=[...m].filter(t=>t.rawVal!==t._oldVal);do{C=new Set;for(let t of new Set(r.flatMap(o=>o._listeners=y(o._listeners))))O(t.f,t.s,t._dom),t._dom=c}while(++e<100&&(r=[...C]).length);let n=[...m].filter(t=>t.rawVal!==t._oldVal);m=c;for(let t of new Set(n.flatMap(o=>o._bindings=y(o._bindings))))G(t._dom,w(t.f,t._dom)),t._dom=c;for(let t of n)t._oldVal=t.rawVal};const a={tags:new Proxy(e=>new Proxy(z,x(e)),x()),hydrate:(e,r)=>G(e,w(r,e)),add:k,state:W,derive:O},S=a.state("");let _,A=!1;function ee(e){S.val=""}function te(){_=document.getElementById("modal"),_.addEventListener("close",ee),a.add(_,()=>S.val)}function re(e){A||(te(),A=!0),S.val=e,_.showModal()}function ne(){_.close(),S.val=""}const j={show:re,hide:ne},{div:oe,input:se,button:ie,h3:ae}=a.tags,le=e=>{const r=a.state(""),n=()=>{alert(`Value: ${r.val}`),e.onDone()};return oe(ae("Let's make a chore"),se({type:"text",placeholder:"Chore name",value:r,oninput:t=>r.val=t.target.value}),ie({onclick:n},"Create"))},{h1:de,div:ce,button:ue}=a.tags,N=()=>{const e=async()=>{j.show(le({onDone:()=>{j.hide()}}))};return ce(de("Welcome to chortle"),ue({onclick:e},"Create new chore"))},{div:fe}=a.tags,he=()=>fe("About page"),{div:ge}=a.tags,pe=()=>ge("Page not found"),B={"":N,home:N,about:he,notFound:pe};let d=null;function D(){return d?!1:(console.error("IndexedDB is not initialized. Call init() first."),!0)}function me(){return new Promise((e,r)=>{const n=indexedDB.open("chortle",1);n.onupgradeneeded=t=>{d=t.target.result,d.createObjectStore("errors",{keyPath:"id",autoIncrement:!0}),d.createObjectStore("chores",{keyPath:"name"})},n.onsuccess=t=>{d=t.target.result,e({})},n.onerror=t=>{console.error("IndexedDB error:",t.target.error),r(t.target.error)}})}function _e(e,r){if(!D())try{d.transaction(e,"readwrite").objectStore(e).add(r)}catch{}}function we(e){return new Promise((r,n)=>{if(D())return n(new Error("IndexedDB is not initialized"));const s=d.transaction(e,"readwrite").objectStore(e).clear();s.onsuccess=()=>{r("All errors cleared from IndexedDB.")},s.onerror=i=>{n(i.target.error)}})}function ve(e){return D()?Promise.resolve([]):new Promise((r,n)=>{const s=d.transaction(e,"readonly").objectStore(e).getAll();s.onsuccess=()=>{r(s.result)},s.onerror=i=>{n(i.target.error)}})}const K={init:me,store:_e,clear:we,query:ve},ye="errors";function be(e){K.store(ye,{error:{message:e.message,source:e.filename,lineno:e.lineno,colno:e.colno,error:e.error},timestamp:new Date})}const Se={log:be},R=a.state(()=>"");function H(){const e=location.hash.substring(1);R.val=B[e]||B.notFound}async function Pe(){await K.init(),a.add(document.getElementById("app"),()=>R.val()),H()}window.addEventListener("hashchange",H);window.addEventListener("DOMContentLoaded",Pe);window.addEventListener("error",Se.log);
